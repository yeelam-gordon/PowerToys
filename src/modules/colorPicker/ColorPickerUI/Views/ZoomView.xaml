<UserControl
    x:Class="ColorPicker.Views.ZoomView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:behaviors="clr-namespace:ColorPicker.Behaviors"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:e="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:shaders="clr-namespace:ColorPicker.Shaders"
    Background="Transparent"
    Focusable="False"
    mc:Ignorable="d">

    <Border
        x:Name="WindowBorder"
        Margin="12"
        HorizontalAlignment="Center"
        VerticalAlignment="Center"
        Background="{DynamicResource LayerFillColorDefaultBrush}"
        BorderBrush="{DynamicResource SurfaceStrokeColorDefaultBrush}"
        BorderThickness="1"
        CornerRadius="16">
        <Grid>
            <!-- Main zoom image display -->
            <Image
                Width="{Binding Width, Mode=TwoWay}"
                Height="{Binding Height, Mode=TwoWay}"
                Margin="3"
                RenderOptions.BitmapScalingMode="NearestNeighbor"
                Source="{Binding ZoomArea}"
                Stretch="Fill">
                <e:Interaction.Behaviors>
                    <behaviors:ResizeBehavior Width="{Binding DesiredWidth}" Height="{Binding DesiredHeight}" />
                    <behaviors:GridEffectBehavior Effect="{Binding ElementName=gridEffect}" ZoomFactor="{Binding ZoomFactor}" />
                </e:Interaction.Behaviors>
                <Image.Effect>
                    <shaders:GridShaderEffect x:Name="gridEffect" />
                </Image.Effect>
            </Image>

            <!-- Crosshair lines for precise color picking -->
            <Line
                x:Name="VerticalCrosshair"
                Stroke="White"
                StrokeThickness="1"
                X1="{Binding Width, Converter={StaticResource HalfValueConverter}}" 
                Y1="0"
                X2="{Binding Width, Converter={StaticResource HalfValueConverter}}" 
                Y2="{Binding Height}"
                Opacity="0.7">
                <Line.Effect>
                    <DropShadowEffect ShadowDepth="0" BlurRadius="2" Color="Black" Opacity="0.7" />
                </Line.Effect>
            </Line>
            
            <Line
                x:Name="HorizontalCrosshair"
                Stroke="White"
                StrokeThickness="1"
                X1="0" 
                Y1="{Binding Height, Converter={StaticResource HalfValueConverter}}"
                X2="{Binding Width}" 
                Y2="{Binding Height, Converter={StaticResource HalfValueConverter}}"
                Opacity="0.7">
                <Line.Effect>
                    <DropShadowEffect ShadowDepth="0" BlurRadius="2" Color="Black" Opacity="0.7" />
                </Line.Effect>
            </Line>
            
            <!-- Color name display -->
            <Border 
                VerticalAlignment="Bottom" 
                HorizontalAlignment="Center" 
                Margin="0,0,0,5" 
                Background="#CC000000" 
                CornerRadius="4" 
                Padding="8,4">
                <TextBlock 
                    Text="{Binding ColorName}" 
                    Foreground="White" 
                    FontSize="11" 
                    FontWeight="SemiBold"
                    HorizontalAlignment="Center"/>
            </Border>
        </Grid>
    </Border>
</UserControl>
